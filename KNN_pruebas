
import duckdb as dd
import pandas as pd
import numpy as np
from sklearn.neighbors import KNeighborsRegressor
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.metrics import mean_squared_error
from sklearn.model_selection import train_test_split
#%%
df = pd.read_excel('/home/Estudiante/Escritorio/alturas.xlsx')
query_filtrados="""
                SELECT "Altura (cm)" AS altura_hijo, Mami AS altura_madre
                FROM df
                WHERE Sexo == 'M'
"""

df_filtrados= dd.query(query_filtrados).df()
df_filtrados=df_filtrados.dropna()
df_filtrados.plot(x="altura_madre",y="altura_hijo",kind="scatter")

#la altura del hijo en funcion de la altura de la madre
#%%
MSE_k = [[1, 0], [2, 0], [3, 0], [4, 0], [5, 0], [10, 0], [15, 0], [20, 0], [25, 0]]

for tupla in MSE_k:
    knn = KNeighborsRegressor(n_neighbors=tupla[0])
    
    knn.fit(df_filtrados[['altura_madre']], df_filtrados['altura_hijo'])
    
    ypred = knn.predict(df_filtrados[['altura_madre']])
    
    tupla[1]=mean_squared_error(df_filtrados['altura_hijo'], ypred)
    
    np.sqrt(mean_squared_error(df_filtrados['altura_hijo'], ypred))
    

    
